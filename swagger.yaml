openapi: 3.0.0
info:
  title: Kendo Mooncake Central Kitchen System API
  description: API documentation for the Kendo Mooncake Central Kitchen System - A comprehensive backend solution for managing mooncake production, inventory, and distribution
  version: 1.0.0
  contact:
    name: API Support
    email: support@kendomooncake.com

servers:
  - url: http://localhost:5000
    description: Development server
  - url: https://api.kendomooncake.com
    description: Production server

tags:
  - name: Health
    description: System health check endpoints
  - name: Authentication
    description: User authentication and authorization endpoints
  - name: Categories
    description: Product category management endpoints
  - name: Ingredients
    description: Ingredient and raw material management endpoints
  - name: Products
    description: Product management with recipe and bundle capabilities
  - name: Batches
    description: Batch management endpoints

paths:
  /api/auth/register:
    post:
      tags:
        - Authentication
      summary: Register a new user
      description: Create a new user account. StoreStaff must be assigned to a store, while Manager/KitchenStaff/Admin cannot have a storeId.
      operationId: register
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
                - fullName
                - email
                - roleId
              properties:
                username:
                  type: string
                  minLength: 3
                  example: 'john.doe'
                password:
                  type: string
                  minLength: 6
                  example: 'password123'
                fullName:
                  type: string
                  example: 'John Doe'
                email:
                  type: string
                  format: email
                  example: 'john.doe@kendomooncake.com'
                roleId:
                  type: string
                  format: objectId
                  description: Role ObjectId - use seeded role IDs
                  example: '507f1f77bcf86cd799439011'
                storeId:
                  type: string
                  format: objectId
                  description: Store ObjectId (required only for StoreStaff role)
                  example: '507f1f77bcf86cd799439012'
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'User registered successfully'
                  token:
                    type: string
                    example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
                  user:
                    $ref: '#/components/schemas/UserResponse'
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/login:
    post:
      tags:
        - Authentication
      summary: Login user
      description: Authenticate user with username and password, returns JWT token
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  example: 'admin'
                password:
                  type: string
                  example: 'admin123'
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Login successful'
                  token:
                    type: string
                    example: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'
                  user:
                    $ref: '#/components/schemas/UserResponse'
        '401':
          description: Unauthorized - invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/auth/me:
    get:
      tags:
        - Authentication
      summary: Get current user
      description: Get the currently authenticated user's information
      operationId: getMe
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully retrieved user information
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/UserResponse'
        '401':
          description: Unauthorized - no token or invalid token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/categories:
    get:
      tags:
        - Categories
      summary: Get all categories
      description: Retrieve list of all product categories
      operationId: getCategories
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully retrieved categories
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 5
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Category'
        '401':
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      tags:
        - Categories
      summary: Create new category
      description: Create a new product category (Admin/Manager only)
      operationId: createCategory
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
              properties:
                name:
                  type: string
                  example: 'Mooncake'
                description:
                  type: string
                  example: 'Traditional mooncake products'
      responses:
        '201':
          description: Category created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Category created successfully'
                  data:
                    $ref: '#/components/schemas/Category'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden - insufficient permissions
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/categories/{id}:
    get:
      tags:
        - Categories
      summary: Get category by ID
      description: Retrieve a single category by its ID
      operationId: getCategoryById
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Category ID
      responses:
        '200':
          description: Successfully retrieved category
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Category'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags:
        - Categories
      summary: Update category
      description: Update an existing category (Admin/Manager only)
      operationId: updateCategory
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Category ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  example: 'Mooncake - Updated'
                description:
                  type: string
                  example: 'Updated description'
      responses:
        '200':
          description: Category updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Category updated successfully'
                  data:
                    $ref: '#/components/schemas/Category'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Categories
      summary: Delete category
      description: Delete a category (Admin/Manager only). Cannot delete if used by products.
      operationId: deleteCategory
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Category ID
      responses:
        '200':
          description: Category deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Category deleted successfully'
                  data:
                    type: object
        '400':
          description: Cannot delete - category in use
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '404':
          description: Category not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/ingredients:
    get:
      tags:
        - Ingredients
      summary: Get all ingredients
      description: Retrieve list of all ingredients
      operationId: getIngredients
      security:
        - BearerAuth: []
      responses:
        '200':
          description: Successfully retrieved ingredients
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 10
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Ingredient'

    post:
      tags:
        - Ingredients
      summary: Create new ingredient
      description: Create a new ingredient (Admin/Manager only)
      operationId: createIngredient
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - unit
                - costPrice
              properties:
                name:
                  type: string
                  example: 'Flour'
                unit:
                  type: string
                  enum: ['kg', 'g', 'l', 'ml', 'pcs']
                  example: 'kg'
                costPrice:
                  type: number
                  example: 50000
                warningThreshold:
                  type: number
                  example: 10
      responses:
        '201':
          description: Ingredient created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Ingredient created successfully'
                  data:
                    $ref: '#/components/schemas/Ingredient'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/ingredients/{id}:
    get:
      tags:
        - Ingredients
      summary: Get ingredient by ID
      description: Retrieve a single ingredient by its ID
      operationId: getIngredientById
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Ingredient ID
      responses:
        '200':
          description: Successfully retrieved ingredient
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Ingredient'
        '404':
          description: Ingredient not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags:
        - Ingredients
      summary: Update ingredient
      description: Update an existing ingredient (Admin/Manager only)
      operationId: updateIngredient
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Ingredient ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                unit:
                  type: string
                  enum: ['kg', 'g', 'l', 'ml', 'pcs']
                costPrice:
                  type: number
                warningThreshold:
                  type: number
      responses:
        '200':
          description: Ingredient updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Ingredient updated successfully'
                  data:
                    $ref: '#/components/schemas/Ingredient'

    delete:
      tags:
        - Ingredients
      summary: Delete ingredient
      description: Delete an ingredient (Admin/Manager only). Cannot delete if used in recipes.
      operationId: deleteIngredient
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Ingredient ID
      responses:
        '200':
          description: Ingredient deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Ingredient deleted successfully'
                  data:
                    type: object

  /api/products:
    get:
      tags:
        - Products
      summary: Get all products
      description: Retrieve list of all products with optional category filter
      operationId: getProducts
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: categoryId
          schema:
            type: string
          description: Filter by category ID
      responses:
        '200':
          description: Successfully retrieved products
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 15
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Product'

    post:
      tags:
        - Products
      summary: Create new product
      description: Create a new product with recipe and/or bundle items (Admin/Manager only)
      operationId: createProduct
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - sku
                - categoryId
                - price
                - shelfLifeDays
              properties:
                name:
                  type: string
                  example: 'Green Bean Mooncake'
                sku:
                  type: string
                  example: 'MOON-GB-001'
                categoryId:
                  type: string
                  format: objectId
                  example: '507f1f77bcf86cd799439011'
                price:
                  type: number
                  example: 150000
                shelfLifeDays:
                  type: number
                  example: 30
                image:
                  type: string
                  example: 'https://example.com/mooncake.jpg'
                recipe:
                  type: array
                  items:
                    type: object
                    properties:
                      ingredientId:
                        type: string
                        format: objectId
                      quantity:
                        type: number
                  example:
                    - ingredientId: '507f1f77bcf86cd799439012'
                      quantity: 0.5
                    - ingredientId: '507f1f77bcf86cd799439013'
                      quantity: 0.2
                bundleItems:
                  type: array
                  items:
                    type: object
                    properties:
                      childProductId:
                        type: string
                        format: objectId
                      quantity:
                        type: number
                  example:
                    - childProductId: '507f1f77bcf86cd799439014'
                      quantity: 2
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Product created successfully'
                  data:
                    $ref: '#/components/schemas/Product'

  /api/products/{id}:
    get:
      tags:
        - Products
      summary: Get product by ID
      description: Retrieve a single product with full details
      operationId: getProductById
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Product ID
      responses:
        '200':
          description: Successfully retrieved product
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Product'

    put:
      tags:
        - Products
      summary: Update product
      description: Update an existing product (Admin/Manager only)
      operationId: updateProduct
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Product ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                sku:
                  type: string
                categoryId:
                  type: string
                price:
                  type: number
                shelfLifeDays:
                  type: number
                image:
                  type: string
                recipe:
                  type: array
                  items:
                    type: object
                    properties:
                      ingredientId:
                        type: string
                      quantity:
                        type: number
                bundleItems:
                  type: array
                  items:
                    type: object
                    properties:
                      childProductId:
                        type: string
                      quantity:
                        type: number
      responses:
        '200':
          description: Product updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Product updated successfully'
                  data:
                    $ref: '#/components/schemas/Product'

    delete:
      tags:
        - Products
      summary: Delete product
      description: Delete a product (Admin/Manager only). Cannot delete if used in bundles.
      operationId: deleteProduct
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Product ID
      responses:
        '200':
          description: Product deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: 'Product deleted successfully'
                  data:
                    type: object

  /health:
    get:
      tags:
        - Health
      summary: Health Check
      description: Check if the API server is running and healthy
      operationId: healthCheck
      responses:
        '200':
          description: Server is healthy and running
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Kendo Mooncake Central Kitchen System is running
                  timestamp:
                    type: string
                    format: date-time
                    example: '2026-01-14T12:00:00.000Z'

  /api/batches:
    get:
      tags:
        - Batches
      summary: Get all batches
      description: Retrieve a list of all production batches
      operationId: getBatches
      responses:
        '200':
          description: Successfully retrieved batches
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  count:
                    type: integer
                    example: 10
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Batch'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    post:
      tags:
        - Batches
      summary: Create a new batch
      description: Create a new production batch with manufacturing and expiration details
      operationId: createBatch
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - batchCode
                - productId
                - mfgDate
                - expDate
                - currentQuantity
              properties:
                batchCode:
                  type: string
                  description: Unique batch code identifier
                  example: 'BATCH-2026-001'
                productId:
                  type: string
                  format: objectId
                  description: Reference to the product (MongoDB ObjectId)
                  example: '507f1f77bcf86cd799439011'
                mfgDate:
                  type: string
                  format: date
                  description: Manufacturing date (YYYY-MM-DD)
                  example: '2026-01-14'
                expDate:
                  type: string
                  format: date
                  description: Expiration date (YYYY-MM-DD) - must be after mfgDate
                  example: '2026-02-14'
                currentQuantity:
                  type: number
                  description: Current quantity in stock
                  minimum: 0
                  example: 1000
      responses:
        '201':
          description: Batch created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Batch created successfully
                  data:
                    $ref: '#/components/schemas/Batch'
        '400':
          description: Bad request - validation error or duplicate batch code
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/batches/{id}:
    get:
      tags:
        - Batches
      summary: Get batch by ID
      description: Retrieve a single batch by its ID
      operationId: getBatchById
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Batch ID (MongoDB ObjectId)
          example: '507f1f77bcf86cd799439011'
      responses:
        '200':
          description: Successfully retrieved batch
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Batch'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    put:
      tags:
        - Batches
      summary: Update batch
      description: Update an existing batch by its ID
      operationId: updateBatch
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Batch ID (MongoDB ObjectId)
          example: '507f1f77bcf86cd799439011'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                batchCode:
                  type: string
                  example: 'BATCH-2026-001-UPDATED'
                productId:
                  type: string
                  format: objectId
                  example: '507f1f77bcf86cd799439011'
                mfgDate:
                  type: string
                  format: date
                  example: '2026-01-14'
                expDate:
                  type: string
                  format: date
                  example: '2026-02-14'
                currentQuantity:
                  type: number
                  minimum: 0
                  example: 900
      responses:
        '200':
          description: Batch updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Batch updated successfully
                  data:
                    $ref: '#/components/schemas/Batch'
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

    delete:
      tags:
        - Batches
      summary: Delete batch
      description: Delete a batch by its ID
      operationId: deleteBatch
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: Batch ID (MongoDB ObjectId)
          example: '507f1f77bcf86cd799439011'
      responses:
        '200':
          description: Batch deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Batch deleted successfully
                  data:
                    type: object
        '404':
          description: Batch not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    Batch:
      type: object
      required:
        - batchCode
        - productId
        - mfgDate
        - expDate
        - currentQuantity
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        batchCode:
          type: string
          description: Unique batch code identifier
          example: 'BATCH-2026-001'
        productId:
          type: string
          format: objectId
          description: Reference to the product
          example: '507f1f77bcf86cd799439011'
        mfgDate:
          type: string
          format: date
          description: Manufacturing date
          example: '2026-01-14'
        expDate:
          type: string
          format: date
          description: Expiration date
          example: '2026-02-14'
        currentQuantity:
          type: number
          description: Current quantity in stock
          minimum: 0
          example: 1000
        createdAt:
          type: string
          format: date-time
          description: Timestamp when the batch was created
        updatedAt:
          type: string
          format: date-time
          description: Timestamp when the batch was last updated

    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: An error occurred
        stack:
          type: string
          description: Error stack trace (only in development)

    User:
      type: object
      required:
        - username
        - passwordHash
        - fullName
        - email
        - roleId
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        username:
          type: string
          minLength: 3
          description: Unique username
          example: 'john.doe'
        passwordHash:
          type: string
          description: Hashed password (never exposed in responses)
        fullName:
          type: string
          description: User's full name
          example: 'John Doe'
        email:
          type: string
          format: email
          description: Unique email address
          example: 'john.doe@kendomooncake.com'
        roleId:
          type: string
          format: objectId
          description: Reference to Role
          example: '507f1f77bcf86cd799439011'
        storeId:
          type: string
          format: objectId
          nullable: true
          description: Reference to Store (required for StoreStaff, null for others)
          example: '507f1f77bcf86cd799439012'
        isActive:
          type: boolean
          default: true
          description: Whether the user account is active
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    UserResponse:
      type: object
      properties:
        id:
          type: string
          format: objectId
          example: '507f1f77bcf86cd799439011'
        username:
          type: string
          example: 'admin'
        fullName:
          type: string
          example: 'System Administrator'
        email:
          type: string
          example: 'admin@kendomooncake.com'
        role:
          type: string
          description: Role name
          example: 'Admin'
        storeId:
          type: string
          format: objectId
          nullable: true
          example: null
        storeName:
          type: string
          nullable: true
          example: null
        isActive:
          type: boolean
          example: true

    Role:
      type: object
      required:
        - roleName
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        roleName:
          type: string
          enum: ['Admin', 'Manager', 'StoreStaff', 'KitchenStaff', 'Coordinator']
          description: Role name
          example: 'Admin'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Store:
      type: object
      required:
        - storeName
        - address
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        storeName:
          type: string
          description: Store name
          example: 'Kendo Central Store'
        address:
          type: string
          description: Store address
          example: '123 Main Street, District 1, Ho Chi Minh City'
        status:
          type: boolean
          default: true
          description: Store operational status
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Category:
      type: object
      required:
        - name
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        name:
          type: string
          description: Category name
          example: 'Mooncake'
        description:
          type: string
          description: Category description
          example: 'Traditional mooncake products'
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Ingredient:
      type: object
      required:
        - name
        - unit
        - costPrice
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        name:
          type: string
          description: Ingredient name
          example: 'Flour'
        unit:
          type: string
          enum: ['kg', 'g', 'l', 'ml', 'pcs']
          description: Unit of measurement
          example: 'kg'
        costPrice:
          type: number
          description: Cost price per unit
          minimum: 0
          example: 50000
        warningThreshold:
          type: number
          description: Warning threshold for low stock
          minimum: 0
          default: 10
          example: 10
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    Product:
      type: object
      required:
        - name
        - sku
        - categoryId
        - price
        - shelfLifeDays
      properties:
        _id:
          type: string
          format: objectId
          description: Auto-generated MongoDB ObjectId
        name:
          type: string
          description: Product name
          example: 'Green Bean Mooncake'
        sku:
          type: string
          description: Stock Keeping Unit (unique identifier)
          example: 'MOON-GB-001'
        categoryId:
          type: object
          description: Product category (populated)
          properties:
            _id:
              type: string
            name:
              type: string
            description:
              type: string
        price:
          type: number
          description: Wholesale price
          minimum: 0
          example: 150000
        shelfLifeDays:
          type: number
          description: Product shelf life in days
          minimum: 1
          example: 30
        image:
          type: string
          description: Product image URL
          example: 'https://example.com/mooncake.jpg'
        recipe:
          type: array
          description: Recipe ingredients with quantities
          items:
            type: object
            properties:
              ingredientId:
                type: object
                description: Ingredient details (populated)
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  unit:
                    type: string
                  costPrice:
                    type: number
              quantity:
                type: number
                description: Quantity of ingredient required
                example: 0.5
        bundleItems:
          type: array
          description: Bundle/combo product items
          items:
            type: object
            properties:
              childProductId:
                type: object
                description: Child product details (populated)
                properties:
                  _id:
                    type: string
                  name:
                    type: string
                  sku:
                    type: string
                  price:
                    type: number
              quantity:
                type: number
                description: Quantity of child product in bundle
                example: 2
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Enter your JWT token in the format **Bearer &lt;token&gt;**
